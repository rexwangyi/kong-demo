# Kong API Gateway Postman 测试指南

## 导入测试集合

1. 打开 Postman
2. 点击左上角的 "Import" 按钮
3. 将 `postman_collection.json` 文件拖入或选择导入
4. 确认导入

## 测试集合结构

测试集合包含四个主要部分：

### 1. 基础 API 测试

- **获取基础信息**: 测试 `/api/info` 端点
- **获取用户列表**: 测试 `/api/users` 端点
- **回显测试**: 测试 POST 请求和请求体处理

### 2. 认证测试

- **带认证的信息获取**: 使用 API key 访问
- **未认证的信息获取**: 不带 API key 访问（预期失败）

### 3. Kong Admin API

- **获取服务列表**: 查看所有已配置的服务
- **获取路由列表**: 查看所有已配置的路由
- **获取插件列表**: 查看所有已启用的插件
- **获取消费者列表**: 查看所有已创建的消费者

### 4. 插件测试

- **速率限制测试**: 测试请求频率限制
- **请求转换测试**: 测试请求头的转换

## 使用说明

1. **环境设置**

   - 确保 Kong 和测试 API 服务都已启动
   - 默认使用 localhost 和标准端口（8000/8001）

2. **认证测试**

   - API Key 已设置为 `demo-api-key`
   - 可以在 Headers 中修改 apikey 值进行不同场景测试

3. **测试步骤**

   1. 先运行基础 API 测试，确保服务正常
   2. 测试未认证访问，确认返回 401
   3. 使用正确的 API key 测试认证访问
   4. 查看 Admin API 了解系统配置
   5. 测试各个插件功能

4. **响应验证**
   - 检查状态码是否符合预期
   - 验证响应头中的 Kong 相关信息
   - 确认响应体格式和内容

## 常见问题

1. **连接问题**

   - 确认 Kong 服务正在运行
   - 验证端口是否正确（8000/8001）
   - 检查 Docker 容器状态

2. **认证失败**

   - 确认 API key 是否正确
   - 检查 header 名称是否为 `apikey`
   - 验证 key-auth 插件是否正确配置

3. **请求失败**
   - 检查请求路径是否正确（需要包含 `/api` 前缀）
   - 确认请求方法（GET/POST）是否正确
   - 验证请求体格式（如果需要）

## 进阶测试

完成基本测试后，你可以：

1. 修改请求参数测试不同场景
2. 添加新的测试用例
3. 创建环境变量管理不同配置
4. 编写测试脚本自动验证响应
5. 使用 Newman 运行自动化测试
